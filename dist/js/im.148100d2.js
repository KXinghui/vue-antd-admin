(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["im"],{"0538":function(t,e,n){"use strict";var a=n("1c0b"),o=n("861d"),i=[].slice,r={},c=function(t,e,n){if(!(e in r)){for(var a=[],o=0;o<e;o++)a[o]="a["+o+"]";r[e]=Function("C,a","return new C("+a.join(",")+")")}return r[e](t,n)};t.exports=Function.bind||function(t){var e=a(this),n=i.call(arguments,1),r=function(){var a=n.concat(i.call(arguments));return this instanceof r?c(e,a.length,a):e.apply(t,a)};return o(e.prototype)&&(r.prototype=e.prototype),r}},"05b0":function(t,e,n){var a=n("07c6");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var o=n("499e").default;o("46f1139b",a,!0,{sourceMap:!1,shadowMode:!1})},"07c6":function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,".identity-login{width:100%;margin:0 auto}.ant-tabs-nav-scroll{display:flex}.login-scan-code-wrap,.login-wrap{display:flex;flex-direction:column;justify-content:center;align-items:center}.login-scan-code-wrap .login-scan-code{width:160px;height:160px}.login-scan-code-wrap{margin:.4rem 0 1.3rem}.login-scan-code-wrap .login-scan-code-expiration{display:flex;justify-content:center;align-items:center;position:absolute;width:170px;height:170px;background-color:rgba(177,180,182,.4)}.identity-login-footer,.identity-login-header{margin:-1rem 0 0}",""]),t.exports=e},"15c4":function(t,e,n){"use strict";var a=n("d4ec"),o=n("bee2"),i=n("262e"),r=n("2caf"),c=n("3d83"),s=n("9390"),l=function(t){Object(i["a"])(n,t);var e=Object(r["a"])(n);function n(){return Object(a["a"])(this,n),e.apply(this,arguments)}return Object(o["a"])(n,[{key:"insert",value:function(t,e){return c["b"].post(this.buildUrl(""),t,e)}},{key:"update",value:function(t,e){return c["b"].post(this.buildUrl(""),t,e)}},{key:"delete",value:function(t,e){return c["b"].delete(this.buildUrl(""),t,e)}},{key:"get",value:function(t,e){return c["b"].get(this.buildUrl(""),t,e)}},{key:"list",value:function(t,e){return c["b"].post(this.buildUrl("/list"),t,e)}},{key:"listAccurate",value:function(t,e){return this.list(Object.assign(t,{listMode:"accurate"}),e)}},{key:"listFuzzy",value:function(t,e){return this.list(Object.assign(t,{listMode:"fuzzy"}),e)}},{key:"pageList",value:function(t,e){return c["b"].post(this.buildUrl("/pageList"),t,e)}},{key:"pageListAccurate",value:function(t,e){return this.pageList(Object.assign(t,{listMode:"accurate"}),e)}},{key:"pageListFuzzy",value:function(t,e){return this.pageList(Object.assign(t,{listMode:"fuzzy"}),e)}},{key:"tableList",value:function(t,e){return c["b"].post(this.buildUrl("/tableList"),t,e)}},{key:"tableListAccurate",value:function(t,e){return this.tableList(Object.assign(t,{listMode:"accurate"}),e)}},{key:"tableListFuzzy",value:function(t,e){return this.tableList(Object.assign(t,{listMode:"fuzzy"}),e)}}]),n}(s["a"]);e["a"]=l},"1d8b":function(t,e,n){var a=n("5fdc");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var o=n("499e").default;o("203caf1e",a,!0,{sourceMap:!1,shadowMode:!1})},"257e":function(t,e,n){"use strict";function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.d(e,"a",(function(){return a}))},"262e":function(t,e,n){"use strict";function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function o(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}n.d(e,"a",(function(){return o}))},2702:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-row",[n("a-col",{directives:[{name:"viewer",rawName:"v-viewer",value:{movable:!0,filter:function(){return!t.isBatch}},expression:"{\n        movable: true,\n        filter: function() {\n          return !isBatch;\n        }\n      }"}],attrs:{xs:24,sm:20,md:20,lg:10,xl:10}},[t.isChatFriend?n("div",t._l(t.chatRecords,(function(e){return n("base-record",{key:e.id,attrs:{"chat-user":t.identity,"chat-record":e,"is-batch":t.isBatch,"chat-record-ids":t.chatRecordIds},on:{changeChatRecord:t.changeChatRecord}})})),1):n("div")])],1)],1)},o=[],i=n("b5d2"),r={name:"ChatUserRecord",mixins:[i["a"]],data:function(){return{msName:"im",chatFriend:null,isChatFriend:!1}},props:{chatUserId:{type:[String],default:"",required:!0}},beforeMount:function(){console.log(this.chatUserId)},mounted:function(){console.log(this.chatUserId)}},c=r,s=n("2877"),l=Object(s["a"])(c,a,o,!1,null,null,null);e["default"]=l.exports},2938:function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"c",(function(){return b})),n.d(e,"b",(function(){return p}));n("caad"),n("b0c0"),n("2532");var a=n("257e"),o=n("262e"),i=n("2caf"),r=n("d4ec"),c=n("bee2"),s=n("ade3"),l=function(){function t(e,n,a,o){Object(r["a"])(this,t),Object(s["a"])(this,"id",void 0),Object(s["a"])(this,"name",void 0),Object(s["a"])(this,"value",void 0),Object(s["a"])(this,"desc",void 0),this.id=e,this.name=n,this.value=a,this.desc=o}return Object(c["a"])(t,[{key:"equals",value:function(t){return this.id==t|this.value==t|this.name==t}}],[{key:"enums",value:function(e,n,a,o){return new t(e,n,a,o)}},{key:"of",value:function(e){var n=new t;if(e||0==e)for(var a in this){var o=[this[a]["id"],this[a]["name"],this[a]["value"]];o.includes(e)&&(n=this[a])}return n}},{key:"selectOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"desc",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id",n=[];for(var a in this)n.push({enum:this[a],name:this[a][t],value:this[a][e]});return n}}]),t}(),u=function(t){Object(o["a"])(n,t);var e=Object(i["a"])(n);function n(t,o,i,c,l){var u;return Object(r["a"])(this,n),u=e.call(this,t,o,i,c),Object(s["a"])(Object(a["a"])(u),"mapping",void 0),u.mapping=l,u}return Object(c["a"])(n,null,[{key:"enums",value:function(t,e,a,o,i){return new n(t,e,a,o,i)}},{key:"of",value:function(t){var e=new n;if(t||0==t)for(var a in this){var o=[this[a]["id"],this[a]["name"],this[a]["value"],this[a]["mapping"]];o.includes(t)&&(e=this[a])}return e}}]),n}(l),d=function(t){Object(o["a"])(n,t);var e=Object(i["a"])(n);function n(){return Object(r["a"])(this,n),e.apply(this,arguments)}return n}(l);Object(s["a"])(d,"FEMALE",d.enums(0,"FEMALE","FeMale","女")),Object(s["a"])(d,"MALE",d.enums(1,"MALE","Male","男"));var f=function(t){Object(o["a"])(n,t);var e=Object(i["a"])(n);function n(){return Object(r["a"])(this,n),e.apply(this,arguments)}return n}(u);Object(s["a"])(f,"USERNAME",f.enums(0,"USERNAME","UserName","用户名","username")),Object(s["a"])(f,"PASSWORD",f.enums(1,"PASSWORD","Password","密码","password")),Object(s["a"])(f,"MAIL",f.enums(2,"MAIL","Mail","邮箱","mail")),Object(s["a"])(f,"MOBILE",f.enums(3,"MOBILE","Mobile","手机","mobile")),Object(s["a"])(f,"SCAN_CODE",f.enums(4,"SCAN_CODE","ScanCode","扫码","scanCode")),Object(s["a"])(f,"GITHUB",f.enums(5,"GITHUB","GitHub","GitHub","github")),Object(s["a"])(f,"GITEE",f.enums(6,"GITEE","Gitee","Gitee","gitee")),Object(s["a"])(f,"OSCHINA",f.enums(7,"OSCHINA","OSChina","开源中国","oschina")),Object(s["a"])(f,"DINGTALK",f.enums(8,"DINGTALK","DingTalk","钉钉","dingtalk")),Object(s["a"])(f,"ALIPAY",f.enums(9,"ALIPAY","Alipay","支付宝","alipay")),Object(s["a"])(f,"WECHAT",f.enums(10,"WECHAT","WeChat","微信","wechat")),Object(s["a"])(f,"QQ",f.enums(11,"QQ","QQ","qq","qq")),Object(s["a"])(f,"MICRO_BLOG",f.enums(12,"MICRO_BLOG","MicroBlog","微博","microblog")),Object(s["a"])(f,"BAIDU",f.enums(13,"BAIDU","Baidu","百度","baidu")),Object(s["a"])(f,"WECHAT_MP",f.enums(14,"WeChatMP","微信小程序","wechatmp"));var b=function(t){Object(o["a"])(n,t);var e=Object(i["a"])(n);function n(){return Object(r["a"])(this,n),e.apply(this,arguments)}return n}(u);Object(s["a"])(b,"USER",b.enums(0,"USER","user","用户","user")),Object(s["a"])(b,"SYS_USER",b.enums(1,"SYS_USER","sysuser","系统用户","sysUser")),Object(s["a"])(b,"CHAT_USER",b.enums(2,"CHAT_USER","chatuser","聊天用户","chatUser"));var p=function(t){Object(o["a"])(n,t);var e=Object(i["a"])(n);function n(){return Object(r["a"])(this,n),e.apply(this,arguments)}return n}(l);Object(s["a"])(p,"NON",p.enums(0,"NON","Non","非加解密模式")),Object(s["a"])(p,"SYMMETRIC",p.enums(1,"SYMMETRIC","Symmetric","对称加解密模式")),Object(s["a"])(p,"ASYMMETRIC",p.enums(2,"ASYMMETRIC","Asymmetric","非对称加解密模式")),Object(s["a"])(p,"MIX",p.enums(3,"MIX","Mix","混合加解密模式"))},"2caf":function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));n("4ae1"),n("3410");function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}n("d3b7"),n("25f0");function o(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var i=n("53ca"),r=n("257e");function c(t,e){return!e||"object"!==Object(i["a"])(e)&&"function"!==typeof e?Object(r["a"])(t):e}function s(t){var e=o();return function(){var n,o=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return c(this,n)}}},"314e":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat-login-wrap"},[n("a-row",{attrs:{type:"flex",justify:"center"}},[n("a-col",{attrs:{xs:22,sm:18,md:10,lg:6,xl:6}},[n("h1",{staticStyle:{"margin-top":"2rem"},attrs:{align:"center"}},[t._v("IM")])])],1),n("identity-login",{attrs:{"identity-role":"user"}})],1)},o=[],i=n("e2a8"),r={name:"ChatLogin",components:{IdentityLogin:i["a"]},data:function(){return{}}},c=r,s=(n("4757"),n("2877")),l=Object(s["a"])(c,a,o,!1,null,null,null);e["default"]=l.exports},3410:function(t,e,n){var a=n("23e7"),o=n("d039"),i=n("7b0b"),r=n("e163"),c=n("e177"),s=o((function(){r(1)}));a({target:"Object",stat:!0,forced:s,sham:!c},{getPrototypeOf:function(t){return r(i(t))}})},"36e5":function(t,e,n){var a=n("942d");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var o=n("499e").default;o("f536fcd6",a,!0,{sourceMap:!1,shadowMode:!1})},4757:function(t,e,n){"use strict";n("1d8b")},"4ae1":function(t,e,n){var a=n("23e7"),o=n("d066"),i=n("1c0b"),r=n("825a"),c=n("861d"),s=n("7c73"),l=n("0538"),u=n("d039"),d=o("Reflect","construct"),f=u((function(){function t(){}return!(d((function(){}),[],t)instanceof t)})),b=!u((function(){d((function(){}))})),p=f||b;a({target:"Reflect",stat:!0,forced:p,sham:p},{construct:function(t,e){i(t),r(e);var n=arguments.length<3?t:i(arguments[2]);if(b&&!f)return d(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var a=[null];return a.push.apply(a,e),new(l.apply(t,a))}var o=n.prototype,u=s(c(o)?o:Object.prototype),p=Function.apply.call(t,u,e);return c(p)?p:u}})},5159:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat-addressbook-wrap"},[n("base-header"),n("base-tab-bar",{attrs:{"base-tab-bars":t.baseTabBars,"active-item-key":t.activeKey,color:t.color,"active-color":t.activeColor},on:{change:t.changeActiveTab}})],1)},o=[],i=n("b5d2"),r={name:"ChatGroupMember",mixins:[i["a"]],data:function(){return{msName:"im",activeTabIndex:1}}},c=r,s=(n("62cd"),n("2877")),l=Object(s["a"])(c,a,o,!1,null,null,null);e["default"]=l.exports},"5fdc":function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,".chat-login-wrap{height:100%;width:100%;background-color:#f5f5f5}.chat-login-wrap .identity-login{margin-top:3.2rem}.chat-login-wrap h1{color:#eaa254;transition:.5s}.chat-login-wrap h1:hover{color:#eaa254;text-shadow:0 0 .1em,0 0 .3em}",""]),t.exports=e},"62cd":function(t,e,n){"use strict";n("36e5")},"67cd":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat-user-friend-wrap"})},o=[],i={name:"ChatUserFriend",data:function(){return{}},props:{chatUserId:{type:[String],default:"",required:!0}}},r=i,c=n("2877"),s=Object(c["a"])(r,a,o,!1,null,null,null);e["default"]=s.exports},"7d01":function(t,e,n){"use strict";n("05b0")},9390:function(t,e,n){"use strict";n("99af"),n("b0c0");var a=n("d4ec"),o=n("bee2"),i=n("ade3"),r=(n("d81d"),function(){function t(e){Object(a["a"])(this,t),Object(i["a"])(this,"httpStatusCode",void 0),Object(i["a"])(this,"httpStatusMsg",void 0),Object(i["a"])(this,"code",void 0),Object(i["a"])(this,"msg",void 0),Object(i["a"])(this,"entity",void 0),Object(i["a"])(this,"list",void 0),Object(i["a"])(this,"map",void 0),Object(i["a"])(this,"edcSign",void 0),Object(i["a"])(this,"localeLangMsg",void 0);var n=e.httpStatusCode,o=e.httpStatusMsg,r=e.code,c=e.msg,s=e.entity,l=e.list,u=e.map,d=e.edcSign,f=e.localeLangMsg;this.httpStatusCode=n,this.httpStatusMsg=o,this.code=r,this.msg=c,this.entity=s,this.list=l,this.map=u,this.edcSign=d,this.localeLangMsg=f}return Object(o["a"])(t,[{key:"isIng",value:function(){return t.ING==this.code||202==this.httpStatusCode}},{key:"isSucc",value:function(){return t.SUCC==this.code}},{key:"isFail",value:function(){return t.FAIL==this.code}},{key:"isError",value:function(){return t.ERROR==this.code}},{key:"isRepeat",value:function(){return t.REPEAT==this.code}},{key:"isFrequent",value:function(){return t.FREQUENT==this.code}}]),Object(o["a"])(t,[{key:"unSign",value:function(){return Object.assign({},this,{edcSign:""})}},{key:"getInMap",value:function(t){return this.map[t]}}]),t}());Object(i["a"])(r,"ING","0-1"),Object(i["a"])(r,"SUCC","1"),Object(i["a"])(r,"FAIL","0"),Object(i["a"])(r,"ERROR","-1"),Object(i["a"])(r,"REPEAT","2"),Object(i["a"])(r,"FREQUENT","3");var c=r,s=n("4360"),l=n("2938"),u=function(){function t(e){Object(a["a"])(this,t),Object(i["a"])(this,"namespace",void 0),this.namespace=e}return Object(o["a"])(t,[{key:"buildUrl",value:function(t){return"".concat(this.namespace).concat(t)}},{key:"respResult",value:function(t){var e=new c(t.data),n=s["a"].getters.identity.tokenMap.pmsnEnDeCryptMode;if(l["b"].NON.equals(n))return e;switch(n){case l["b"].SYMMETRIC.name:break;case l["b"].ASYMMETRIC.name:break;case l["b"].MIX.name:break;default:break}return e}}]),t}();e["a"]=u},"942d":function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,".chat-addressbook-wrap{height:100%;background-color:#f5f5f5}",""]),t.exports=e},"9cc4":function(t,e,n){"use strict";var a=n("d4ec"),o=n("bee2"),i=n("262e"),r=n("2caf"),c=n("3d83"),s=n("9390"),l=function(t){Object(i["a"])(n,t);var e=Object(r["a"])(n);function n(){return Object(a["a"])(this,n),e.apply(this,arguments)}return Object(o["a"])(n,[{key:"drawScanCode",value:function(t,e,n){var a="/draw";return t&&(a="/".concat(t,"/draw")),c["b"].post(this.buildUrl(a),e,n)}},{key:"enterView",value:function(t,e){var n="/enterview";return c["b"].post(this.buildUrl(n),t,e)}},{key:"confirmLogin",value:function(t,e){var n="/confirm";return c["b"].post(this.buildUrl(n),t,e)}}]),n}(s["a"]),u=new l("/scancode/login");e["a"]=u},e2a8:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"identity-login"},[n("div",{staticClass:"identity-login-header"},[t._t("header")],2),n("a-tabs",{staticClass:"identity-login-tabs",attrs:{"default-active-key":"localAccount","tab-position":t.tabOption.position,"tab-bar-style":t.tabOption.tabBarStyle,size:t.tabOption.size,"tab-bar-gutter":t.tabOption.tabBarGutter},on:{change:t.changeTabs}},[n("a-tab-pane",{key:"localAccount"},[n("span",{attrs:{slot:"tab"},slot:"tab"},[n("a-icon",{attrs:{type:"user"}}),t._v(" 本地账号登录 ")],1),n("a-form-model",t._b({attrs:{model:t.form,layout:t.formOption.layout}},"a-form-model",t.formItemLayout,!1),[n("a-form-model-item",{attrs:{label:"本地账号"}},[n("a-input",{attrs:{autocomplete:"username",placeholder:"用户名/手机/邮箱","allow-clear":""},model:{value:t.form.localAccount,callback:function(e){t.$set(t.form,"localAccount",e)},expression:"form.localAccount"}})],1),n("a-form-model-item",{attrs:{label:"密码"}},[n("a-input-password",{attrs:{autocomplete:"current-password",placeholder:"密码","allow-clear":""},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),n("a-form-model-item",{attrs:{"wrapper-col":t.buttonItemLayout.wrapperCol}},[n("a-button",{attrs:{type:"primary",loading:t.loginLoading.localAccount,block:""},on:{click:t.loginByLocalAccount}},[t._v(" "+t._s(t.loginLoading.localAccount?"取消登录":"登录")+" ")])],1)],1)],1),n("a-tab-pane",{key:"mail"},[n("span",{attrs:{slot:"tab"},slot:"tab"},[n("a-icon",{attrs:{type:"mail"}}),t._v(" 邮箱登录 ")],1),n("a-form-model",t._b({attrs:{model:t.form,layout:t.formOption.layout}},"a-form-model",t.formItemLayout,!1),[n("a-form-model-item",{attrs:{label:"邮箱"}},[n("a-input",{attrs:{placeholder:"邮箱","allow-clear":""},model:{value:t.form.mail,callback:function(e){t.$set(t.form,"mail",e)},expression:"form.mail"}})],1),n("a-form-model-item",{attrs:{label:"邮箱验证码"}},[n("a-input-group",{attrs:{compact:""}},[n("a-input",{staticStyle:{width:"70%"},attrs:{placeholder:"邮箱验证码","allow-clear":""},model:{value:t.form.svCode,callback:function(e){t.$set(t.form,"svCode",e)},expression:"form.svCode"}}),n("a-button",{staticStyle:{width:"30%"},attrs:{type:"primary"}},[n("icon",{attrs:{icon:"IconFont_send"}}),t._v(" 发送 ")],1)],1)],1),n("a-form-model-item",{attrs:{"wrapper-col":t.buttonItemLayout.wrapperCol}},[n("a-button",{attrs:{type:"primary",loading:t.loginLoading.mail,block:""},on:{click:t.loginByMail}},[t._v(" "+t._s(t.loginLoading.mail?"取消登录":"登录")+" ")])],1)],1)],1),n("a-tab-pane",{key:"mobile"},[n("span",{attrs:{slot:"tab"},slot:"tab"},[n("a-icon",{attrs:{type:"mobile"}}),t._v(" 手机登录 ")],1),n("a-form-model",t._b({attrs:{model:t.form,layout:t.formOption.layout}},"a-form-model",t.formItemLayout,!1),[n("a-form-model-item",{attrs:{label:"手机"}},[n("a-input",{attrs:{placeholder:"手机","allow-clear":""},model:{value:t.form.mobile,callback:function(e){t.$set(t.form,"mobile",e)},expression:"form.mobile"}})],1),n("a-form-model-item",{attrs:{label:"手机验证码"}},[n("a-input-group",{attrs:{compact:""}},[n("a-input",{staticStyle:{width:"70%"},attrs:{placeholder:"手机验证码","allow-clear":""},model:{value:t.form.svCode,callback:function(e){t.$set(t.form,"svCode",e)},expression:"form.svCode"}}),n("a-button",{staticStyle:{width:"30%"},attrs:{type:"primary"}},[n("icon",{attrs:{icon:"IconFont_send"}}),t._v(" 发送 ")],1)],1)],1),n("a-form-model-item",{attrs:{"wrapper-col":t.buttonItemLayout.wrapperCol}},[n("a-button",{attrs:{type:"primary",loading:t.loginLoading.mobile,block:"",disabled:""},on:{click:t.loginByMobile}},[t._v(" "+t._s(t.loginLoading.mobile?"取消登录(暂不支持)":"登录(暂不支持)")+" ")])],1)],1)],1),n("a-tab-pane",{key:"scanCode"},[n("span",{attrs:{slot:"tab"},slot:"tab"},[n("a-icon",{attrs:{type:"qrcode"}}),t._v(" 扫码登录 ")],1),n("div",{staticClass:"login-wrap login-scan-code-wrap"},[n("div",{staticClass:"login-scan-code-wrap"},[n("a-spin",{attrs:{spinning:t.loginLoading.scanCode}},[n("img",{staticClass:"login-scan-code",attrs:{src:t.loginScanCodeSrc}})]),n("div",{directives:[{name:"show",rawName:"v-show",value:0==t.loginScanCodeExpiration,expression:"loginScanCodeExpiration == 0"}],staticClass:"login-scan-code-expiration"},[n("a-button",{attrs:{type:"primary"},on:{click:t.drawLoginScanCode}},[t._v("点击刷新登录二维码")])],1)],1),n("div",{staticClass:"login-scan-code-tips"},[n("a-alert",{attrs:{message:t.loginScanCodeAlert.message,type:t.loginScanCodeAlert.type,"show-icon":""}})],1)])])],1),n("div",{staticClass:"identity-login-footer"},[t._t("footer")],2)],1)},o=[],i=(n("caad"),n("d81d"),n("ade3")),r=n("5530"),c=n("c8d0"),s=n("414a"),l=n("2938"),u=n("d4ec"),d=n("262e"),f=n("2caf"),b=n("bee2"),p=n("15c4"),h=n("3d83"),m=function(t){Object(d["a"])(n,t);var e=Object(f["a"])(n);function n(){return Object(u["a"])(this,n),e.apply(this,arguments)}return Object(b["a"])(n,[{key:"loginByLocalAccount",value:function(t,e){var n="/login/localaccount";return h["b"].post(this.buildUrl(n),t,e)}},{key:"loginByMail",value:function(t,e){var n="/login/mail";return h["b"].post(this.buildUrl(n),t,e)}},{key:"register",value:function(t,e){var n="/register";return h["b"].post(this.buildUrl(n),t,e)}},{key:"updatePassword",value:function(t,e){var n="/password/update";return h["b"].post(this.buildUrl(n),t,e)}},{key:"bindMail",value:function(t,e){var n="/mail/bind";return h["b"].post(this.buildUrl(n),t,e)}},{key:"bindMobile",value:function(t,e){var n="/mobile/bind";return h["b"].post(this.buildUrl(n),t,e)}},{key:"upLoadAvatar",value:function(t,e){var n="/avatar/upload";return h["b"].post(this.buildUrl(n),t,e)}},{key:"getIdentity",value:function(t,e){var n="/identity";return h["b"].get(this.buildUrl(n),t,e)}}]),n}(p["a"]),g=m,v=function(t){Object(d["a"])(n,t);var e=Object(f["a"])(n);function n(){return Object(u["a"])(this,n),e.apply(this,arguments)}return n}(g),y=new v("/user"),O=y,C=function(t){Object(d["a"])(n,t);var e=Object(f["a"])(n);function n(){return Object(u["a"])(this,n),e.apply(this,arguments)}return n}(p["a"]),j=new C("/sysUser"),S=j;function w(t){return l["c"].USER.equals(t)?O:l["c"].SYS_USER.equals(t)?S:O}var L=n("2f62"),k=n("ae88"),A=n("9cc4");function E(t){return"/topic/scancode.login.".concat(t)}var M=n("c82a"),I=["localAccount","mail","mobile","scanCode"],x={name:"IdentityLogin",mixins:[c["a"],s["a"]],data:function(){return{loginCancleTokenSource:{localAccount:null,mail:null,mobile:null,scanCode:null},loginLoading:{localAccount:!1,mail:!1,mobile:!1,scanCode:!1},loginScanCode:"",loginScanCodeBase64:"",loginScanCodeExpiration:-1,loginScanCodeAvatarUrl:"",isConfirmLogin:!1,tabOption:{position:"top",tabBarStyle:{},size:"default"},formOption:{layout:"vertical"},form:{name:""},loginScanCodeAlert:{message:"请扫描二维码登录",type:"warning"}}},props:{identityRole:{type:[String],default:"",required:!0}},computed:Object(r["a"])(Object(r["a"])({},Object(L["d"])({identity:function(t){return t.identity.identity}})),{},{loginScanCodeSrc:function(){var t=this.loginScanCodeBase64;return t?"data:image/png;base64,".concat(t):"/lazy/qrcode.png"}}),methods:Object(r["a"])(Object(r["a"])({},Object(L["c"])(k["b"].NAMESPACE,[k["b"].SET_TOKEN,k["b"].SET_IDENTITY])),{},{changeTabs:function(t){"scanCode"==t&&this.drawLoginScanCode()},loginByLocalAccount:function(){console.log("localAccount login",this.form);var t=this;t.handleCancleWhenLogin("localAccount")||(t.loginLoading["localAccount"]={delay:1500},w(this.identityRole).loginByLocalAccount({localAccount:this.form.localAccount,password:this.form.password},Object(i["a"])({},h["a"],this.getLoginCancleTokenSource("localAccount").token)).then((function(e){t.handleAfterLogin(e.data),t.loginLoading["localAccount"]=!1})).catch((function(){t.loginLoading["localAccount"]=!1})))},loginByMail:function(){console.log("mail login",this.form);var t=this;t.handleCancleWhenLogin("mail")||(t.loginLoading["mail"]={delay:1500},w(this.identityRole).loginByMail({mail:this.form.mail,svCodeKey:this.form.mail,svCode:this.form.svCode},Object(i["a"])({},h["a"],this.getLoginCancleTokenSource("mail").token)).then((function(e){t.handleAfterLogin(e.data),t.loginLoading["mail"]=!1})).catch((function(){t.loginLoading["mail"]=!1})))},loginByMobile:function(){console.log("mobile login",this.form);var t=this;t.handleCancleWhenLogin("mobile")||(t.loginLoading["mobile"]={delay:1500},w(this.identityRole).loginByMobile({mobile:this.form.mobile,svCodeKey:this.form.mobile,svCode:this.form.svCode},Object(i["a"])({},h["a"],this.getLoginCancleTokenSource("mobile").token)).then((function(e){t.handleAfterLogin(e.data),t.loginLoading["mobile"]=!1})).catch((function(){t.loginLoading["mobile"]=!1})))},drawLoginScanCode:function(){var t=this;t.loginScanCodeExpiration&&t.loginScanCodeExpiration>0||(t.loginScanCodeExpiration=-1,t.loginLoading.scanCode=!0,t.loginScanCodeAlert={message:"正在刷新登录二维码",type:"info"},A["a"].drawScanCode(t.identityRole).then((function(e){if(1==e.data.code){t.loginScanCode&&t.wsunsubscribe(E(t.loginScanCode));var n=e.data.map,a=n.scanCode,o=n.scanCodeBase64,i=n.scanCodeExpiration;t.loginScanCode=a,t.loginScanCodeBase64=o,t.loginScanCodeExpiration=i,t.loginLoading.scanCode=!1,t.wssubscribe(E(a),(function(e){var n=JSON.parse(e.body),a=n.code,o=n.msg,i=n.map,r=i.avatarUrl,c=i.scanCodeExpiration;if(1==a){c&&(t.loginScanCodeAvatarUrl=r,t.loginScanCodeAlert={message:o||"扫码成功",type:"success"});var s=n.map,l=s.Authorization,u=s.AuthorizationCode,d=s.identity;l&&u&&d&&(t.loginScanCodeAlert={message:o||"扫码登录中。。。",type:"success"},t.handleAfterLogin(n),t.isConfirmLogin=!0)}else(0==c||c)&&(t.loginScanCodeExpiration=c),t.loginScanCodeAlert={message:o||"扫码失败",type:"error"}}),{}),t.loginScanCodeAlert={message:"请扫描二维码登录",type:"warning"},t.loginScanCodeInterval=setInterval((function(){t.isConfirmLogin||(t.loginScanCode="",t.loginScanCodeExpiration=0,t.loginScanCodeAlert={message:"请点击刷新登录二维码",type:"warning"}),clearInterval(t.loginScanCodeInterval)}),1e3*i)}})).catch((function(e){console.log(e),t.loginLoading.scanCode=!1,t.loginScanCodeBase64="",t.loginScanCodeExpiration=0,t.loginScanCodeAlert={message:"刷新登陆二维码失败",type:"error"}})))},getLoginCancleTokenSource:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(I.includes(t)){var n=this.loginCancleTokenSource[t];return!n&&e&&(n=Object(h["c"])(),this.loginCancleTokenSource[t]=n),n}return null},handleAfterLogin:function(t){var e=this,n=t.map,a=n.Authorization,o=n.AuthorizationCode,i=n.identity;a&&o&&i&&(e[k["b"].SET_TOKEN]({token:a,tokenCode:o}),e[k["b"].SET_IDENTITY](i),Object(M["c"])({path:"/"}))},handleCancleWhenLogin:function(t){if(I.includes(t)){var e=this,n=e.loginLoading[t];if(n){var a=e.getLoginCancleTokenSource(t,!1);a&&a.cancel(),e.loginLoading[t]=!1}return n}}}),destroyed:function(){this.loginScanCode&&this.wsunsubscribe(E(this.loginScanCode)),this.wsdisconnect(),this.loginScanCodeInterval&&clearInterval(this.loginScanCodeInterval)}},_=x,R=(n("7d01"),n("2877")),U=Object(R["a"])(_,a,o,!1,null,null,null);e["a"]=U.exports}}]);